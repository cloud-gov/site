---
import Markdown from "./Markdown.astro";

interface Link {
  label: string;
  url: string;
}

interface PagesPricing {
  name: string;
  price: string;
  unit?: string;
  features: string[];
}

interface Pages {
  subhead?: string;
  heading?: string;
  text?: string;
  link?: Link;
  pricing: PagesPricing;
}

interface AppsTier {
  name: string;
  credits: number;
  price: string;
}

interface Apps {
  subhead?: string;
  heading?: string;
  text?: string;
  link?: Link;
  tiers: AppsTier[];
}

interface Props {
  heading?: string;
  intro?: string;
  outro?: string;
  pages?: Pages;
  apps?: Apps;
  color?: string;
}

const { apps, pages, color = "white" } = Astro.props;
---

<section class={`bg-${color}-lightest border-${color}-lighter text-${color}-darkest border-y-1px usa-section`}>
  <div class="grid-container">
    <div class="grid-row">
      <div class="grid-col desktop-lg:margin-left-0 tablet-lg:grid-offset-1">
        <div class="grid-row grid-gap-lg flex-justify flex-align-center">
          <div
            class={`grid-col-12 tablet:grid-col-10 tablet:grid-offset-1 tablet-lg:grid-col-6 tablet-lg:margin-left-0 desktop:grid-col-6 margin-y-8`}>
            <h3 class="font-body-sm text-uppercase text-ls-2 text-medium">{apps.subhead}</h3>
            <h4 class="font-body-xl text-medium">{apps.heading}</h4>

            <Markdown content={apps.text} classes="font-body-md line-height-body-3 margin-bottom-4" inline />

            {
              apps.link && (
                <div class="usa-button-group margin-top-2 margin-bottom-0">
                  <a class="usa-button usa-button--inverse" href={apps.link.url}>
                    {apps.link.label}
                  </a>
                </div>
              )
            }
          </div>
          <div
            class="grid-col-12 tablet:grid-col-8 tablet:grid-offset-1 tablet-lg:margin-left-0 tablet-lg:grid-col-5 desktop:grid-col-5 margin-y-auto text-left">
            <div
              class={`border border-base-lighter border-${color}-light radius-lg bg-white height-full overflow-hidden`}>
              <div
                class="bg-base-lightest padding-top-2 padding-bottom-105 padding-x-3 text-bold font-sans-sm display-flex flex-align-center">
                <div class="flex-1">Tier</div>
                <div class="flex-1 text-right">Credits</div>
                <div class="flex-1 text-right">Annual Price</div>
              </div>

              <ul class="usa-list usa-list--unstyled margin-0">
                {
                  apps.tiers.map((tier) => (
                    <li class="border-top border-base-lighter padding-y-1 padding-x-3 display-flex flex-align-center font-sans-sm">
                      <div class="flex-1 text-medium">{tier.name}</div>
                      <div class="flex-1 text-right font-mono-sm">{tier.credits.toLocaleString()}</div>
                      <div class="flex-1 text-right text-medium">{tier.price}</div>
                    </li>
                  ))
                }
              </ul>
            </div>
          </div>
        </div>

        <div class="grid-row grid-gap-lg flex-justify flex-align-center">
          <div
            class="grid-col-12 tablet:grid-col-10 tablet:grid-offset-1 tablet-lg:grid-col-6 tablet-lg:margin-left-0 margin-y-8 tablet-lg:order-last">
            <h3 class="font-body-sm text-uppercase text-ls-2 text-medium">{pages.subhead}</h3>
            <h4 class="font-body-xl text-medium">{pages.heading}</h4>

            <Markdown content={pages.text} classes="font-body-md line-height-body-3 margin-bottom-4" inline />

            {
              pages.link && (
                <div class="usa-button-group margin-top-2 margin-bottom-0">
                  <a class="usa-button usa-button--inverse" href={pages.link.url}>
                    {pages.link.label}
                  </a>
                </div>
              )
            }
          </div>
          <div
            class="grid-col-12 tablet:grid-col-8 tablet:grid-offset-1 tablet-lg:margin-left-0 tablet-lg:grid-col-5 desktop:grid-col-5 margin-y-auto text-center">
            <div class={`padding-4 border border-base-lighter border-${color}-light radius-lg bg-white height-full`}>
              <h3 class="font-sans-xl text-bold margin-bottom-1 text-center">
                {pages.pricing.name}
              </h3>

              <div class="text-center line-height-sans-1 margin-bottom-3">
                <span class="display-inline-block font-sans-lg text-bold">$</span>
                <span class="font-sans-3xl text-bold">{pages.pricing.price}</span>
                <span class="display-inline-block font-sans-sm text-normal">{pages.pricing.unit}</span>
              </div>
              <ul class="usa-list font-body-md line-height-body-4 text-left">
                {pages.pricing.features.map((feature) => <li class="padding-y-05">{feature}</li>)}
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <style>
    .usa-link {
      position: relative;
    }
    .usa-link .usa-icon {
      position: absolute;
      right: -1rem;
    }
  </style>
</section>
