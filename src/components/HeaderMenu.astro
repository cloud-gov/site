---
import closeIcon from '@uswds/uswds/img/usa-icons/close.svg';
import searchIcon from '@uswds/uswds/img/usa-icons-bg/search--white.svg';

type NavLink = { label: string; href: string };
type ButtonLink = { label: string; href: string; class?: string; };
type NavSection = { label: string; links: NavLink[] };

interface Props {
  logoText: string;
  logoHref: string;
  sections: NavSection[];
  navLinks: NavLink[];
  secondaryLinks: NavLink[];
  buttonLinks: ButtonLink[];
}

const { logoText, logoHref, sections, navLinks, secondaryLinks, buttonLinks } = Astro.props;
---

<div class="usa-overlay"></div>
<header class="usa-header usa-header--extended border-bottom-1px border-base-lighter">
  <div class="usa-navbar">
    <div class="usa-logo">
      <em class="usa-logo__text">
        <a href={logoHref} title={logoText}>{logoText}</a>
      </em>
    </div>
    <button type="button" class="usa-menu-btn">Menu</button>
  </div>

  <nav aria-label="Primary navigation" class="usa-nav ">
    <div class="usa-nav__inner">
      <button type="button" class="usa-nav__close" aria-label="Close menu">
        <img
          src={closeIcon.src}
          role="img"
          alt="Close"
      />
      </button>
      <ul class="usa-nav__primary usa-accordion">
        {sections.map((section, i) => (
          <li class="usa-nav__primary-item">
            <button
              type="button"
              class="usa-accordion__button usa-nav__link"
              aria-expanded="false"
              aria-controls={`nav-section-${i}`}
            >
              <span>{section.label}</span>
            </button>
            <ul id={`nav-section-${i}`} class="usa-nav__submenu">
              {section.links.map(link => (
                <li class="usa-nav__submenu-item">
                  <a href={link.href}>
                    <span>{link.label}</span>
                  </a>
                </li>
              ))}
            </ul>
          </li>
        ))}

        {navLinks.map(link => (
          <li class="usa-nav__primary-item">
            <a href={link.href} class="usa-nav-link">
              <span>{link.label}</span>
            </a>
          </li>
        ))}

        {buttonLinks.map((link, index) => (
          <li
          class={`button-item  display-flex align-items-center padding-y-05 ${index === 0 ? ' margin-left-auto ' : ''}`}
          >
            <a 
              href={link.href} 
              class={`usa-button${link.class ? ` usa-button--${link.class}` : ''}`}
            >
              {link.label}
            </a>
          </li>
        ))}

      </ul>

      <div class="usa-nav__secondary">
        <ul class="usa-nav__secondary-links">
          {secondaryLinks.map(link => (
            <li class="usa-nav__secondary-item">
              <a href={link.href} class="usa-nav-link">
                <span>{link.label}</span>
              </a>
            </li>
          ))}
        </ul>
        <section aria-label="Search component">
          <form class="usa-search usa-search--small" role="search">
            <label class="usa-sr-only" for="search-field">Search</label>
            <input
              class="usa-input"
              id="search-field"
              type="search"
              name="search"
            />
            <button class="usa-button" type="submit">
              <img
              src={searchIcon.src}
              class="usa-search__submit-icon"
              alt="Search"
            />
            </button>
          </form>
        </section>
      </div>
    </div>
  </nav>
</header>

<style>
 /* adjustments to fit buttons in header  */
@media (min-width: 64em) and (min-width: 64em) {
  .usa-header--extended .usa-nav__inner {
      padding-left: 1.25rem;
      padding-right: 1.25rem;
  }
}
@media (min-width: 64em) {
  .usa-header {
    padding-bottom: .25rem;
  }
  .usa-header--extended .usa-nav {
    border-top-width: 0;
  }
  .usa-header--extended .usa-nav__primary {
      margin-left: -0.25rem;
      padding: .25rem 0;
  }
  .usa-nav__primary > .usa-nav__primary-item,
  .usa-header--extended .usa-nav__primary button {
      font-size: 1.05rem;
      font-weight: 700;
      -webkit-font-smoothing: antialiased;
    }
  .usa-nav__submenu .usa-nav__submenu-item a {
    font-size: .95rem;
    font-weight: 600;
    -webkit-font-smoothing: antialiased;
  }
  .usa-nav__submenu {
    width: 20rem;
  }
  .usa-header--extended .usa-nav__primary-item {
    position: relative;
    bottom: -0.5rem;
  }
  .usa-nav__secondary {
    flex-direction: row;
    align-items: center;
    margin-top: 0;
  }
  .usa-nav__secondary-links {
    margin: auto 1rem;
  }
  .usa-nav__secondary .usa-search {
    margin-top: 0;
  }
  .usa-header--extended .usa-logo {
    margin: 1.5rem 0 0.5rem;
  }

}
</style>